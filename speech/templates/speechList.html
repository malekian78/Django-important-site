{% extends 'base.html' %}
{% load static %}

{% block stylesImports %}
  {% comment %} <link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.7/mediaelementplayer.min.css" rel="stylesheet" />
  <link href="{% static './speech-styles.css' %}" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia" /> {% endcomment %}

  <link href="{% static './speech-list-style.css' %}" rel="stylesheet" />
{% endblock %}

{% block javaScripImports %}
  {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.7/mediaelement-and-player.min.js"></script>
  <script src="{% static './speech-javaScript.js' %}"></script> {% endcomment %}

  {% comment %} <script>
    document.addEventListener('DOMContentLoaded', function () {
      const audio = document.getElementById('fc-media') // Replace with the actual ID of your audio element
      const lyricsContainer = document.getElementById('song-lyrics')
      let currentLyricIndex = 0
    
      // Retrieve the lyrics data as a JSON string
      const lyricsData = JSON.parse(document.getElementById('song-lyrics').getAttribute('data-lyrics'))
    
      audio.addEventListener('timeupdate', function () {
        const currentTime = audio.currentTime
    
        // Find the current lyrics based on the time
        while (currentLyricIndex < lyricsData.length - 1 && currentTime >= timeToSeconds(lyricsData[currentLyricIndex + 1].time)) {
          currentLyricIndex++
        }
    
        // Update the displayed lyrics
        lyricsContainer.innerText = lyricsData[currentLyricIndex].lyrics
      })
    
      function timeToSeconds(time) {
        const [minutes, seconds] = time.split(':').map(parseFloat)
        return minutes * 60 + seconds
      }
    })
  </script> {% endcomment %}
{% endblock %}

{% block content %}
  <div class="speeches-container">
    {% comment %}Filters{% endcomment %}
    <div class="filters-for-speech-list">
      <form method="get">
        <div class="search-input-box">
          <input type="text" name="search" placeholder="جستجو..." value="{{ request.GET.search }}" />
          <button type="submit">
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 256 256">
              <g fill="currentColor" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none">
                <g transform="scale(10.66667,10.66667)">
                  <path d="M10,2c-4.40347,0 -8,3.59653 -8,8c0,4.40347 
            3.59653,8 8,8c1.75213,0 3.37052,-0.57793 
            4.69141,-1.54102l5.1543,5.1543c0.31352,0.32654 
            0.77908,0.45808 1.21713,0.34388c0.43805,-0.1142 
            0.78014,-0.45628 0.89433,-0.89433c0.1142,-0.43805 
            -0.01734,-0.90361 -0.34388,-1.21713l-5.1543,-5.1543
            c0.96309,-1.32088 1.54102,-2.93928 1.54102,-4.69141
            c0,-4.40347 -3.59653,-8 -8,-8zM10,4.5c3.05237,0 
            5.5,2.44763 5.5,5.5c0,3.05237 -2.44763,5.5 
            -5.5,5.5c-3.05237,0 -5.5,-2.44763 -5.5,-5.5
            c0,-3.05237 2.44763,-5.5 5.5,-5.5z"></path>
                </g>
              </g>
            </svg>
          </button>
        </div>
        <select name="ordering">
          <option value="-created_at">جدیدترین</option>
          <option value="created_at">قدیمی‌ترین</option>
          <option value="title">محبوب‌ترین</option>
        </select>
      </form>
    </div>

    {% comment %}speech List{% endcomment %}
    <div class="speech-list-panel">
      {% for item in speechList %}
        {% comment %}! speech-card{% endcomment %}
        <a class="speech-card" href="{% url 'speech:detail' speechSlug=item.slug %}">
          <div class="speech-image">
            {% comment %} <img src="{% static 'Screenshot_2014-10-23-16-25-08.png' %}" alt="" /> {% endcomment %}
            <img src="{{ item.image.url }}" alt="" />
          </div>

          <div class="speech-card-contet">
            <div class="speech-card-header">
              {% comment %} <h2>شب پنجم محرم ۱۴۰۴</h2> {% endcomment %}
              <h2>{{ item.title }}</h2>
            </div>
            <p class="speech-card-description">{{ item.sumary }}</p>
            {% comment %} <div class="tags-styles">#محرم #دهه_محرم #محرم۱۴۰۴ #محرم_۱۴۰۴ #سخنرانی_محرم #مراسم_محرم #محرم_حسینی #محرم_ماه_خدا #هیئت #هیئت_آنلاین #مراسم_عزاداری #محرم_مجازی</div> {% endcomment %}
            <div class="speech-card-feedback">
              <span>تعداد بازدید: {{ item.visit_count }}</span>
              <span>تعداد لایک: 700</span>
              <span>
                تاریخ:
                <span dir="ltr">{{ item.event_date_time }}</span>
              </span>
            </div>
          </div>
        </a>
      {% endfor %}

      <div class="pagination-container">
        <ul class="pagination" id="pagination">
          {% comment %}! اولین اولین صفحه{% endcomment %}
          <li class="pagination-item">
            <a href="?page=1" class="pagination-link pagination-arrow {% if not speechList.has_previous %}disabled{% endif %}" data-action="first" aria-label="First page">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="11 17 6 12 11 7"></polyline>
                <polyline points="18 17 13 12 18 7"></polyline>
              </svg>
            </a>
          </li>
          {% comment %}! صفحه قبلی{% endcomment %}
          <li class="pagination-item">
            <a href="?page={% if speechList.has_previous %}{{ speechList.previous_page_number }}{% endif %}" class="pagination-link pagination-arrow {% if not speechList.has_previous %}disabled{% endif %}" data-action="prev" aria-label="Previous page">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="15 18 9 12 15 6"></polyline>
              </svg>
            </a>
          </li>

          {% for i in speechList.paginator.page_range %}
            {% comment %}یه شرط زیر براشون میزاریم تا به تعداد صفحات مشخصی رندر شود{% endcomment %}
            {% if i >= speechList.number|add:'-2' and i <= speechList.number|add:'2' %}
              {% if speechList.number == i %}
                <li class="pagination-item">
                  <a href="?page={{ i }}" class="pagination-link active">{{ i }}</a>
                </li>
              {% else %}
                <li class="pagination-item">
                  <a href="?page={{ i }}" class="pagination-link">{{ i }}</a>
                </li>
              {% endif %}
              {% comment %}! صفوحات{% endcomment %}
              {% comment %} <li class="pagination-item">
                <a href="#" class="pagination-link active" data-page="1">1</a>
              </li>
              <li class="pagination-item">
                <a href="#" class="pagination-link" data-page="2">2</a>
              </li>
              <li class="pagination-item">
                <a href="#" class="pagination-link" data-page="3">3</a>
              </li>
              <li class="pagination-item">
                <span class="pagination-ellipsis">...</span>
              </li>
              <li class="pagination-item">
                <a href="#" class="pagination-link" data-page="30">30</a>
              </li> {% endcomment %}
            {% elif i == speechList.number|add:'-3' or i == speechList.number|add:'3' %}
              <li class="pagination-item">
                <span class="pagination-ellipsis">...</span>
              </li>
            {% endif %}
          {% endfor %}

          {% comment %}! صفحه بعدی{% endcomment %}
          <li class="pagination-item">
            <a href="?page={% if speechList.has_next %}{{ speechList.next_page_number }}{% endif %}" class="pagination-link pagination-arrow {% if not speechList.has_next %}disabled{% endif %}" data-action="next" aria-label="Next page">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </a>
          </li>
          {% comment %}! آخرین آخرین صفحه{% endcomment %}
          <li class="pagination-item">
            <a href="?page={{ speechList.paginator.num_pages }}" class="pagination-link pagination-arrow {% if not speechList.has_next %}disabled{% endif %}" data-action="last" aria-label="Last page">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="13 17 18 12 13 7"></polyline>
                <polyline points="6 17 11 12 6 7"></polyline>
              </svg>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  {% comment %} <div class="music-player">
    {% for item in speech_list_object %}
      <div class="cover">
        <img alt="" src="{{ item.image.url }}" />
      </div>

      <div class="titre">
        <h3>{{ item.title }}</h3>
      </div>

      <center>
        <a href="{% if speech_list_object.has_previous %}
            
            
            
            
            
            
            
            
            
            
            
            ?page={{ speech_list_object.previous_page_number }}
          {% endif %}">
          <i class="fa fa-step-backward fa-2x"></i>
        </a> &nbsp; &nbsp; &nbsp; <a href="{% if speech_list_object.has_next %}
            
            
            
            
            
            
            
            
            
            
            
            ?page={{ speech_list_object.next_page_number }}
          {% endif %}">
          <i class="fa fa-step-forward fa-2x"></i>
        </a>
      </center>

      <div class="lecteur">
        <audio class="fc-media" style="width: 100%;" id="fc-media">
          <source src="{% if item.audio_file %}
              {{ item.audio_file.url }}
            {% endif %}"
            type="audio/mp3" />
        </audio>
      </div>
    {% endfor %}
  </div> {% endcomment %}
{% endblock %}
